<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Celestial Correspondences — v0.1</title>
  <style>
    :root{
      --bg:#0a0b10;
      --card:#11131a;
      --muted:#9aa3b2;
      --text:#ecf0ff;
      --primary:#4ea1ff;
      --accent:#6ee7ff;
      --ring: rgba(78,161,255,.4);
      --ok:#63d39a;
      --warn:#f7b955;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue";
      background: radial-gradient(1200px 700px at 70% -10%, #10204a33, transparent), var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:28px}
    header{
      display:flex;align-items:center;gap:14px;justify-content:space-between;margin-bottom:18px
    }
    .brand{display:flex;gap:12px;align-items:center}
    .logo{
      width:38px;height:38px;border-radius:10px;
      background: conic-gradient(from 210deg, #001a3a, #0040a3, #0061ff, #27e2ff, #001a3a);
      box-shadow: 0 0 24px #1b77ff44 inset, 0 0 50px #1b77ff33;
      border:1px solid #1b77ff66;
    }
    h1{font-size:18px;margin:0;letter-spacing:.5px}
    .sub{font-size:12px;color:var(--muted);margin-top:2px}
    .grid{
      display:grid;grid-template-columns: 1.2fr .8fr;gap:18px;
    }
    @media (max-width: 900px){ .grid{grid-template-columns: 1fr; } }
    .card{
      background:linear-gradient(180deg,#0d1018,#0b0e15);
      border: 1px solid #1b2230;
      border-radius:16px; padding:18px;
      box-shadow: 0 0 0 1px #0c1220 inset, 0 12px 30px rgba(0,0,0,.35);
    }
    .toolbar{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    select, button, textarea, input{
      background:#0d1424;border:1px solid #1e2b45;color:var(--text);
      border-radius:10px;padding:10px 12px;font-size:14px;
      outline:none;
    }
    select:focus, textarea:focus, input:focus{ box-shadow: 0 0 0 4px var(--ring); border-color:#2a77ff; }
    button{cursor:pointer}
    .tabs{display:flex;gap:8px;margin:14px 0 10px 0;flex-wrap:wrap}
    .tab{
      padding:8px 12px;border:1px solid #1e2b45;border-radius:20px;
      background:#0b111d;cursor:pointer;font-size:13px;color:var(--muted)
    }
    .tab.active{color:#fff;border-color:#2a77ff;background:#0b1325;box-shadow:0 0 0 3px var(--ring)}
    .row{display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap}
    .col{flex:1;min-width:260px}
    .kvs{display:grid;grid-template-columns: 1fr 2fr;gap:8px;align-items:start}
    .kvs div{padding:8px 10px;border:1px solid #1b2230;border-radius:10px;background:#0d111a}
    .k{color:var(--muted);font-size:12px}
    .v{font-size:14px}
    .muted{color:var(--muted)}
    .btn{background:#102243;border:1px solid #1b3b7a}
    .btn:hover{filter:brightness(1.05)}
    .btn.primary{background:#0b2a6b;border-color:#1b56c7}
    .note{width:100%;min-height:120px;resize:vertical}
    .json{width:100%;min-height:180px;font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;resize:vertical}
    .pill{font-size:11px;padding:4px 8px;border-radius:999px;background:#0e1422;border:1px solid #1d2944;color:#9cb4ff}
    .row-just{display:flex;justify-content:space-between;align-items:center;margin:6px 0 12px}
    .hint{font-size:12px;color:var(--muted)}
    footer{margin-top:16px;font-size:12px;color:#7e889a;display:flex;gap:10px;flex-wrap:wrap}
    .ok{color:var(--ok)} .warn{color:var(--warn)}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid #1d2944;background:#0c1324;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Celestial Correspondences <span class="pill">v0.1</span></h1>
          <div class="sub">Pattern-style browser for planetary correspondences • local-only</div>
        </div>
      </div>
      <div class="chip"><span>Storage</span> <strong id="storageStatus">local</strong></div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="toolbar">
          <label>
            <span class="muted" style="font-size:12px">Planet</span><br/>
            <select id="planet">
              <option>Sun</option><option>Moon</option><option>Mercury</option>
              <option>Venus</option><option>Mars</option><option>Jupiter</option><option>Saturn</option>
            </select>
          </label>

          <button class="btn" id="btnInsight">Generate Insight</button>
          <button class="btn" id="btnEdit">Edit Data</button>
          <button class="btn" id="btnExport">Export JSON</button>
          <label class="btn" for="fileImport" style="display:inline-flex;align-items:center;gap:8px;cursor:pointer">
            Import JSON <input type="file" id="fileImport" accept="application/json" style="display:none">
          </label>
        </div>

        <div class="tabs" id="tabs">
          <button class="tab active" data-tab="vedic">Hindu / Vedic</button>
          <button class="tab" data-tab="kabbalah">Kabbalah</button>
          <button class="tab" data-tab="orisha">Orisha</button>
          <button class="tab" data-tab="vodou">Vodou</button>
        </div>

        <div id="viewMode">
          <div class="row">
            <div class="col">
              <div class="row-just">
                <strong>Correspondences</strong>
                <span class="hint">Read-only • click “Edit Data” to customize</span>
              </div>
              <div class="kvs" id="kvs"></div>
            </div>
            <div class="col">
              <div class="row-just">
                <strong>Notes</strong>
                <span class="hint" id="noteHint">Saved per planet + system</span>
              </div>
              <textarea id="notes" class="note" placeholder="Your observations and lineage-specific nuance…"></textarea>
              <div style="display:flex;gap:10px;margin-top:10px">
                <button class="btn primary" id="btnSaveNote">Save Note</button>
                <span class="hint" id="noteSaved"></span>
              </div>
            </div>
          </div>
        </div>

        <div id="editMode" style="display:none">
          <div class="row-just">
            <strong>Edit Data (JSON)</strong>
            <span class="hint">Editing <span id="editScope"></span> • <a href="#" id="resetDefaults">reset to defaults</a></span>
          </div>
          <textarea id="jsonEditor" class="json" spellcheck="false"></textarea>
          <div style="display:flex;gap:10px;margin-top:10px">
            <button class="btn primary" id="btnSaveData">Save Data</button>
            <button class="btn" id="btnCancelEdit">Cancel</button>
            <span class="hint" id="dataSaved"></span>
          </div>
        </div>
      </section>

      <aside class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <strong>Insight</strong>
          <span class="hint">Pattern-like • offline</span>
        </div>
        <div id="insight" class="muted">Click “Generate Insight” to draft a short reflection you can refine.</div>
        <hr style="border:none;height:1px;background:#141a26;margin:16px 0">
        <div class="hint">
          Roadmap:
          <ul>
            <li>Sidereal/Tropical + Signs & Nakshatras</li>
            <li>Daily transit with AI (serverless)</li>
            <li>Community feed (Supabase)</li>
          </ul>
        </div>
      </aside>
    </div>

    <footer>
      <span>Pro tip: export your JSON as a house “canon,” then re-import on new devices.</span>
    </footer>
  </div>

  <script>
    // ---------- DEFAULT DATA (seed) ----------
    const DEFAULT_DATA = {
      Sun: {
        vedic: {
          deities: ["Surya","Savitur","Agni (as solar fire)"],
          qualities: ["Atma (Self)", "Authority", "Vitality", "Dharma"],
          day: "Sunday", color: "Saffron/Gold", metal: "Gold",
          mantra: "Om Suryaya Namah", offerings: ["Water (Arghya)","Marigold","Frankincense"]
        },
        kabbalah: {
          sephira: "Tiphareth (Beauty)",
          path: ["Vav (6) contextually", "Solar harmonization"],
          archangel: "Raphael", correspondences: ["Heart","Equilibrium","Child of the Sun"]
        },
        orisha: {
          deity: "Orunmila (wisdom/oracle) or Shango aspects (solar-royal) — varies by lineage",
          colors: ["Gold","White"], day: "Sunday"
        },
        vodou: {
          lwa: "Gran Chemin / Ogou Shango (varies by house)",
          attributes: ["Nobility","Justice","Will"], offerings: ["Candle (gold)", "Clarity water"]
        }
      },
      Moon: {
        vedic:{ deities:["Chandra","Soma"], qualities:["Manas (Mind)","Emotion","Mother"], day:"Monday", color:"White", mantra:"Om Chandraya Namah"},
        kabbalah:{ sephira:"Yesod (Foundation)", archangel:"Gabriel", correspondences:["Dreams","Imagination","Cycles"]},
        orisha:{ deity:"Yemaya or Oshun (lunar aspects vary by current)", colors:["Silver","White"]},
        vodou:{ lwa:"La Sirèn / Erzulie Freda (aspects)", attributes:["Tides","Dreams","Affection"]}
      },
      Mercury:{
        vedic:{ deities:["Budha"], qualities:["Intellect","Speech","Trade"], day:"Wednesday", color:"Green", mantra:"Om Budhaya Namah"},
        kabbalah:{ sephira:"Hod (Glory)", archangel:"Mikael", correspondences:["Language","Reason","Craft"]},
        orisha:{ deity:"Eleggua/Esu (roads/communication) — house-specific", colors:["Red/Black"], day:"Monday/Wednesday"},
        vodou:{ lwa:"Legba", attributes:["Crossroads","Speech","Access"]}
      },
      Venus:{
        vedic:{ deities:["Shukra"], qualities:["Shukra (seed)","Love","Art"], day:"Friday", color:"White/Teal", mantra:"Om Shukraya Namah"},
        kabbalah:{ sephira:"Netzach (Victory)", archangel:"Haniel", correspondences:["Desire","Aesthetics","Fertility"]},
        orisha:{ deity:"Oshun", colors:["Yellow","Gold"], day:"Friday"},
        vodou:{ lwa:"Erzulie Freda", attributes:["Beauty","Sweetness","Luxury"]}
      },
      Mars:{
        vedic:{ deities:["Mangala","Skanda"], qualities:["Courage","Heat","Discipline"], day:"Tuesday", color:"Red", mantra:"Om Mangalaya Namah"},
        kabbalah:{ sephira:"Gevurah (Severity)", archangel:"Kamael", correspondences:["Boundary","Strength","Surgery"]},
        orisha:{ deity:"Shango/Ogun (war/fire/iron) — depends on current", colors:["Red","Brown"], day:"Tuesday"},
        vodou:{ lwa:"Ogou", attributes:["Iron","War","Strategy"]}
      },
      Jupiter:{
        vedic:{ deities:["Brihaspati"], qualities:["Guru","Expansion","Dharma"], day:"Thursday", color:"Yellow", mantra:"Om Gurave Namah"},
        kabbalah:{ sephira:"Chesed (Mercy)", archangel:"Tzadkiel", correspondences:["Benevolence","Law","Abundance"]},
        orisha:{ deity:"Orunmila (Ifa) or Obatala aspects (wisdom) — varies", colors:["Yellow","Green","White"], day:"Thursday"},
        vodou:{ lwa:"Damballah (wisdom/creation) in some houses", attributes:["Blessing","Order","Grace"]}
      },
      Saturn:{
        vedic:{ deities:["Shani"], qualities:["Karma","Time","Structure"], day:"Saturday", color:"Indigo/Black", mantra:"Om Sham Shanicharaya Namah"},
        kabbalah:{ sephira:"Binah (Understanding)", archangel:"Tzaphkiel", correspondences:["Boundaries","Mourning","Architecture"]},
        orisha:{ deity:"Obatala (older/white) or Ogun (iron/discipline) per lineage", colors:["White","Black"], day:"Saturday"},
        vodou:{ lwa:"Baron / Loko (order of time/limit) by current", attributes:["Endurance","Grave wisdom"]}
      }
    };

    // ---------- STATE ----------
    const state = {
      data: loadData(),
      planet: 'Sun',
      tab: 'vedic', // vedic|kabbalah|orisha|vodou
    };

    function loadData(){
      try{
        const raw = localStorage.getItem('cc:data');
        if(!raw) return structuredClone(DEFAULT_DATA);
        return JSON.parse(raw);
      }catch(e){
        console.warn('Failed to load data, using defaults', e);
        return structuredClone(DEFAULT_DATA);
      }
    }
    function saveData(){
      localStorage.setItem('cc:data', JSON.stringify(state.data));
      statusFlash('dataSaved','Saved ✓');
      render();
    }
    function keyNote(){ return `note:${state.planet}:${state.tab}`; }
    function loadNote(){ return localStorage.getItem(keyNote()) || ''; }
    function saveNote(text){
      localStorage.setItem(keyNote(), text);
      statusFlash('noteSaved','Saved ✓');
    }
    function statusFlash(id, text){
      const el = document.getElementById(id);
      el.textContent = text;
      setTimeout(()=>{ el.textContent=''; }, 1500);
    }

    // ---------- UI HOOKS ----------
    const $planet = document.getElementById('planet');
    const $tabs = document.getElementById('tabs');
    const $kvs = document.getElementById('kvs');
    const $insight = document.getElementById('insight');
    const $notes = document.getElementById('notes');
    const $btnSaveNote = document.getElementById('btnSaveNote');
    const $btnInsight = document.getElementById('btnInsight');
    const $btnEdit = document.getElementById('btnEdit');
    const $btnExport = document.getElementById('btnExport');
    const $fileImport = document.getElementById('fileImport');
    const $viewMode = document.getElementById('viewMode');
    const $editMode = document.getElementById('editMode');
    const $jsonEditor = document.getElementById('jsonEditor');
    const $btnSaveData = document.getElementById('btnSaveData');
    const $btnCancelEdit = document.getElementById('btnCancelEdit');
    const $resetDefaults = document.getElementById('resetDefaults');
    const $editScope = document.getElementById('editScope');

    $planet.addEventListener('change', (e)=>{ state.planet = e.target.value; render(); });
    $tabs.addEventListener('click', (e)=>{
      const t = e.target.closest('.tab'); if(!t) return;
      state.tab = t.dataset.tab; render();
    });
    $btnSaveNote.addEventListener('click', ()=> saveNote($notes.value));

    $btnInsight.addEventListener('click', ()=>{
      const p = state.planet, t = state.tab;
      const d = state.data[p]?.[t] || {};
      const facets = Object.entries(d).map(([k,v])=>{
        const val = Array.isArray(v) ? v.join(', ') : v;
        return `${capitalize(k)}: ${val}`;
      }).slice(0,4).join(' • ');

      const templates = [
        `${p} through your ${titleCase(t)} lens highlights ${facets}. Honor what feels alive today.`,
        `Attune to ${p}: notice how ${facets}. Make one small choice that aligns with this current.`,
        `Your ${titleCase(t)} view of ${p} invites you to embody ${facets}. Keep it simple, keep it true.`
      ];
      $insight.textContent = templates[Math.floor(Math.random()*templates.length)];
    });

    // Edit flow
    $btnEdit.addEventListener('click', ()=>{
      $viewMode.style.display='none';
      $editMode.style.display='block';
      $editScope.textContent = `${state.planet} • ${titleCase(state.tab)}`;
      const slice = state.data[state.planet]?.[state.tab] ?? {};
      $jsonEditor.value = JSON.stringify(slice, null, 2);
    });
    $btnCancelEdit.addEventListener('click', ()=>{
      $editMode.style.display='none';
      $viewMode.style.display='block';
    });
    $btnSaveData.addEventListener('click', ()=>{
      try{
        const parsed = JSON.parse($jsonEditor.value || '{}');
        state.data[state.planet] = state.data[state.planet] || {};
        state.data[state.planet][state.tab] = parsed;
        saveData();
        $btnCancelEdit.click();
      }catch(e){
        alert('Invalid JSON. Please fix and try again.\n\n' + e.message);
      }
    });
    $resetDefaults.addEventListener('click', (e)=>{
      e.preventDefault();
      if(confirm('Reset ALL data to defaults?')){
        state.data = structuredClone(DEFAULT_DATA);
        saveData();
      }
    });

    // Export / Import
    $btnExport.addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(state.data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'celestial-correspondences.json';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });
    $fileImport.addEventListener('change', async (e)=>{
      const file = e.target.files?.[0]; if(!file) return;
      try{
        const text = await file.text();
        const parsed = JSON.parse(text);
        state.data = parsed;
        saveData();
      }catch(err){
        alert('Import failed: ' + err.message);
      }finally{
        e.target.value = '';
      }
    });

    function render(){
      // tabs
      document.querySelectorAll('.tab').forEach(el=>{
        el.classList.toggle('active', el.dataset.tab===state.tab);
      });
      // kvs
      const d = state.data[state.planet]?.[state.tab] || {};
      const entries = Object.entries(d);
      $kvs.innerHTML = entries.length ? entries.map(([k,v])=>`
        <div class="k">${escapeHtml(titleCase(k))}</div>
        <div class="v">${escapeHtml(Array.isArray(v)? v.join(', ') : String(v))}</div>
      `).join('') : `<div class="k">Empty</div><div class="v muted">Click “Edit Data” to add your correspondences.</div>`;

      // notes
      $notes.value = loadNote();
      document.getElementById('noteHint').textContent = `Saved per planet + ${titleCase(state.tab)}`;
      // storage
      document.getElementById('storageStatus').textContent = 'local';
    }

    function escapeHtml(s){
      return s.replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;',"'":'&#39;','"':'&quot;'}[c]));
    }
    function titleCase(s){ return (s||'').toString().replace(/[_-]/g,' ').replace(/\w\S*/g, t => t[0].toUpperCase()+t.slice(1).toLowerCase()); }
    function capitalize(s){ s = String(s||''); return s.charAt(0).toUpperCase()+s.slice(1); }

    // init
    render();
  </script>
</body>
</html>
